---
title: "R u Ready? FS2026 | Psychologie der Digitalisierung - Einheit 13"
author: Sandra Grinschgl, Laura Hirt, Lars Schilling
format: 
  revealjs:
    title-slide-attributes:
      data-visibility: hidden
    theme: [default, ../../custom.scss]
    transition: slide
    slide-number: true
    logo: /images/unibe.png
    incremental: false
    self_contained: true
    show-slide-number: all
    smaller: true
    progress: true
    controls: true
    embed-resources: true
bibliography: references.bib
draft: true
---

```{r, echo = FALSE, message=FALSE, warning=FALSE}


options(scipen = 999)
library(tidyverse)
library(palmerpenguins)
library(apaTables)
library(car)
library(afex)
library(emmeans)

library(effectsize)


penguins <- drop_na(palmerpenguins::penguins)


bfi_10_data <- read_delim("raw/bfi_10_data.csv", delim = ";", escape_double = FALSE, trim_ws = TRUE)

dat_full <- read_csv("raw/dat_full.csv")

dat_full_long <- dat_full |>
      pivot_longer(
        cols = c(pre1, pre4),
        names_to = "time_rating",
        values_to = "rating"
      )


dat_full$group_all <- as.factor(dat_full$group_all)

dat_full <- dat_full |>
  mutate(pre1 = pre1*10,
         pre2 = pre2*10,
         pre3 = pre3*10,
         pre4 = pre4*10)
```

## R u Ready? Reproduzierbare Datenaufbereitung und -analyse mit R

FS 2026<br><br><br> **LV-Leitung**: Dr. Sandra Grinschgl / MSc. Laura Hirt<br> **Tutor**: BSc. Lars Schilling<br><br><br>**13. Einheit**, 20.05.2026

------------------------------------------------------------------------

## Heute:

<embed 
  src="../../PDFs/Syllabus.pdf" 
  type="application/pdf"
  style="width:100%; height:90vh;"
>

------------------------------------------------------------------------

## ANOVA - Analysis of Variance

Testet, ob sich Mittelwerte in mehreren Gruppen unterscheiden

**Verschiedene Arten**

-   **One-Way ANOVA (einfaktoriell):**\
    Ein Faktor (eine UV) mit mehr als zwei Stufen.

-   **Mehrfaktorielle ANOVA:**\
    Zwei oder mehr Faktoren (UVs).

-   **Mixed ANOVA:**\
    Kombination aus Within-Subject-Faktoren (Messwiederholung) und Between-Subject-Faktoren.

-   **Multivariate ANOVA (MANOVA):**\
    Mindestens zwei abh√§ngige Variablen.

-   **ANCOVA:**\
    Kontrolle f√ºr eine zus√§tzliche Drittvariable (Kovariate).

------------------------------------------------------------------------

## Voraussetzungen

-   **Normalverteilung der abh√§ngigen Variablen**
-   **Varianzhomogenit√§t (Levene-Test)**
-   **Sph√§rizit√§t (Mauchly Test) bei Mixed ANOVA**

------------------------------------------------------------------------

## Einfaktorielle ANOVA

**Unterscheiden sich die Mittelwerte der drei Gruppen voneinander?**

**AV**: `mean_rl_all`

**Fixed Effekt:** `group_all` üëâ Dieser Effekt interessiert uns

**Random Intercept:** `(1 | code)` üëâ Irrelevant bei One-Way ANOVA wird aber von der Funktion `afex` verlangt.

<br>

```{r, echo = TRUE}
leveneTest(mean_rl_all ~ group_all, data = dat_full)

```

```{r, echo= TRUE, eval = TRUE}
model_1 <- aov_4(mean_rl_all ~ group_all + (1 | code), data = dat_full)
```

::: notes
Der Random Intercept (1 \| code) ist bei einer einfaktoriellen One-Way ANOVA irrelevant, weil jede Person nur einen einzigen Messwert fuer die AV hat. Die Personenvariabilit√§t wird vom Residuum aufgefangen. W√§re nur relevant bei multilevel strukturen oder messwiederholungen. AFEX ist aber f√ºr mixed designs gebaut, und verangt deshalb einen random Intercept obwohl dieser keinemn effekt hat.
:::

------------------------------------------------------------------------

## Output One-Way ANOVA (Beispiel)

```{r, echo= TRUE,, eval=FALSE}
model_1 <- aov_4(mean_rl_all ~ group_all + (1 | code), data = dat_full)

summary(model_1)
```

![](../../images/EH_13/output_anova.png){fig-align="center"}

------------------------------------------------------------------------

## ANOVA: Different Package - same result

**BASE-R**

<br>

```{r, echo=TRUE}

model_aov <- aov(mean_rl_all ~ group_all, data = dat_full)
summary(model_aov)
```

<br>

**aov_ez**

```{r, echo=TRUE}

model_aov_ez <- aov_ez(
  id = "code",
  dv = "mean_rl_all",
  between = "group_all",
  data = dat_full
)

summary(model_aov_ez)


```

------------------------------------------------------------------------

## ANOVA: Effektst√§rken

generalisiertes **`Œ∑2`** & partielles **`Œ∑2`** - Wie viel Varianz wird durch die Gruppenzugeh√∂rigkeit erkl√§rt?

```{r, echo=TRUE}

eta_squared(model_1, generalized = TRUE)

eta_squared(model_1, partial = TRUE)

```

------------------------------------------------------------------------

## Unterschiede generalisiertes und partielles Œ∑¬≤

<br>

-   Das generalisierte und `partielle` `Œ∑¬≤`sind beides Masse, welche den **Anteil an erkl√§rter Varianz** einer **abh√§ngigen Variable** angeben.

<br>

-   Das `generalisierte Œ∑¬≤` berechnet den Anteil der erkl√§rten Varianz einer abh√§ngigen Variable unter **Einbezug der gesamten Varianz, also aller Effekte.**

<br>

-   Das `partielle Œ∑¬≤` beachtet bei der Berechnung des Anteils an erkl√§rter Varianz f√ºr die **abh√§ngige Variable nicht die gesamte Varianz**, sondern nur jene, welche dem **zuvor definierten Effekt** zugeschrieben werden kann.

::: notes
> **Partielles Eta-Quadrat:** Wie gross ist der Effekt dieses Faktors, wenn ich alle anderen Einfluessen ignoriere? Wenn eine Kovariate hinzugefuegt wird und weitere Varianz erklaert, vergroessert sich das partielle Eta-Quadrat tendenziell, da der verbleibende Fehleranteil kleiner wird.
>
> **Generalisertes Eta-Quadrat:** Wie gross ist der Effekt im gesamten Datensatz, also unter Beruecksichtigung aller anderen Quellen der Varianz?
:::

------------------------------------------------------------------------

## Post-Hoc t-Tests mit `pairs`

**Verschiedene M√∂glichkeiten**

-   Klassische t-Tests, wie im Paper und in EH 12

<br>

-   Schneller mit `pairs()`, womit alle m√∂glichen Vergleiche simultan berechnet werden (aber ohne Effektst√§rken) ‚Äì\> Erg√§nzung f√ºr Fortgeschrittene im Hands-On!

<br>

```{r, echo=FALSE, eval = TRUE}
posthoc_tests <- emmeans(object = model_1, specs = ~ group_all)
pairs(posthoc_tests)
```

-   Optimalerweise: Pr√§registrieren, welche Post-Hoc-Tests berechnet werden und wie diese korrigiert werden sollen

------------------------------------------------------------------------

## Korrektur f√ºr multiples Testen:

![](../../images/EH_13/Korrekturen.png){fig-align="center"}

------------------------------------------------------------------------

## Reminder 2x3 ANOVA

**AV** = Rating

**Between Subjects Faktor** = Feedbackgruppe (`below` vs. `control` vs. `above`)

**Within Subjects Faktor:** Messzeitpunkt (Messwiederholter Faktor, `pre 1` vs. `pre 4`)

![](../../images/EH_12/original_results_1.png){fig-align="center"}

------------------------------------------------------------------------

## 2x3 mixed ANOVA: Vorbereitungen

***Mixed-ANOVA mit `afex`***

<br>

**AV** = Rating

<br>

**Between Subjects Faktor** = Feedbackgruppe (`below` vs. `control` vs. `above`)

<br>

**Within Subjects Faktor:** Messzeitpunkt (Messwiederholter Faktor, `pre 1` vs. `pre 4`)

üëâ Long Datensatz

***Muster:***

```{r, echo = TRUE, eval=FALSE}
mixed_anova <- aov_4(AV ~ between_factor + (messwiederholter_faktor | ID) data = dat_full_long)
```

------------------------------------------------------------------------

## Beispielhafter Output mit **Œ∑2**

```{r, echo=TRUE, eval = TRUE}
mixed_anova <- aov_4(rating ~ group_all + (time_rating | code), data = dat_full_long, anova_table = list(es = c("ges" ,"pes")))


summary(mixed_anova)
mixed_anova$anova_table
```

------------------------------------------------------------------------

```{r, echo=TRUE, eval = FALSE}
mixed_anova <- aov_4(rating ~ group_all + (time_rating | code), data = dat_full_long, anova_table = list(es = c("ges" ,"pes")))


summary(mixed_anova)
mixed_anova$anova_table
```

![](../../images/EH_13/output_2x3_anova.png){fig-align="center"}

------------------------------------------------------------------------

## Vergleich mit @grinschgl2021

Im Paper wurde nur das reine **Œ∑2 berichtet. Berechnet mit `eta_squared()`** aus dem Package `effectsize`.

```{r, echo=FALSE}

eta_squared(mixed_anova, partial = FALSE)
```

<br>

We observed a main effect of the factor **‚Äúfeedback group‚Äù, F(2, 156) = 19.74, p \< 0.001, Œ∑2 = 0.12**, as well as a main effect of the factor ‚Äútime of pre-rating‚Äù, **F(1, 156) = 22.67, p \< 0.001, Œ∑2 = 0.04**. Most importantly, we also found a significant interaction between these factors, **F(2, 156) = 20.09, p \< 0.001, Œ∑2 = 0.07**.

------------------------------------------------------------------------

## Verletzungen der Voraussetzungen in ANOVAs

**Normalverteilung (one-way ANOVA)**

-   `Kruskal-Wallis-Test` ‚Äì\> Besonders robust gegen Verletzungen der Normalverteilungsannahme

**Varianzhomogenit√§t**

-   Einfaktoriell: `Welch-ANOVA`

**Mixed ANOVA**

-   Relativ robust gegen√ºber Verletzungen der Normalverteilung

<!-- -->

-   Robuste ANOVA mit `WRS2` Paket

-   Multilevel Model mit `lme4`

Bei @grinschgl2021 wurde dies aber au√üer Acht gelassen. Auf jeden Fall sollte man sich im Vorfeld der Datenerhebung √ºberlegen ob und wie man Voraussetzungen √ºberpr√ºft und wie man bei potenziellen Verletzungen vorgeht.

------------------------------------------------------------------------

## Verletzung Sph√§rizit√§t

**Beispiel aus den Daten Haus√ºbung:**

-   Der **Mauchly-Test** ist relevant bei mindestens **drei Within-Faktoren** (z.B bei der Haus√ºbung) .

-   Sollte nicht signifikant sein, sodass wir **Sph√§rizit√§t** annehmen k√∂nnen (√§hnlich zum Levene Test).

-   Der Test wird automatisch ausgegeben. Wenn nicht signifikant ist Sph√§rizit√§t gegeben, asonsten muss korrigiert werden. üëâ Werte nach **Greenhouse-Geisser-Korrektu**r interpretieren.

    -   Diese werden mit model\$anova_table automatisch ausgegeben. Mit `summary()` bekommt man in der ersten Tabelle die unkorrigierten Werte. Beispiel:

![](../../images/EH_13/Mauchly_Test.png){fig-align="center"}

::: notes
Sph√§rizit√§t in der Statistik ist eine¬†Annahme f√ºr Varianzanalysen mit Messwiederholung (Repeated Measures ANOVA) und bedeutet, dass die Varianzen der Differenzen zwischen allen Paaren von Messzeitpunkten gleich sind, was eine Art ‚ÄûHomogenit√§t der Differenzen‚Äú darstellt. Bei zwei Zeitpunkten gibt es nur eine differenz, also muss sph√§rizit√§t gegeben sein (weil es keine zweite oder dritte differenz gibt mit der man vergleichen k√∂nnte).

Greenhouse‚ÄìGeisser verkleinert die Freiheitsgrade, um p-Werte zu korrigieren, wenn Sph√§rizit√§t verletzt ist.\
Je st√§rker die Verletzung, desto konservativer die Korrektur.
:::

------------------------------------------------------------------------

## Heute haben wir:

-   ANOVAs kennengelernt

-   Post-hoc Tests und Effektst√§rken berechnet

-   Vorausetzungspr√ºfungen und Alternativen angeschaut

------------------------------------------------------------------------

## Bis n√§chste Woche:

-   **Muddiest Points!!** Bis Sonntag! siehe Ilias EH 13

-   **Haus√ºbung** bis Freitag **und Peerfeedback** bis Mittwoch**!**
