---
title: "R u Ready? HS2025 | Psychologie der Digitalisierung - Einheit 8"
author: Sandra Grinschgl, Aaron Friedli, Lars Schilling
format: 
  revealjs:
    title-slide-attributes:
      data-visibility: hidden
    theme: [default, ../../custom.scss]
    transition: slide
    slide-number: true
    logo: /images/unibe.png
    incremental: false
    self_contained: true
    show-slide-number: all
    smaller: true
    progress: true
    controls: true
    embed-resources: true
---

```{r, echo = FALSE, message=FALSE}

library(palmerpenguins)
library(tidyverse)
library(palmerpenguins)
penguins <- palmerpenguins::penguins
```

## R u Ready? Reproduzierbare Datenaufbereitung und -analyse mit R

HS 2025<br><br><br> **LV-Leitung**: Dr. Sandra Grinschgl / MSc. Aaron Friedli<br> **Tutor**: BSc. Lars Schilling<br><br><br>**8. Einheit**, 05.11.2025

------------------------------------------------------------------------

## Heute:

<iframe src="../../PDFs/Syllabus.pdf" width="100%" height="600px">

</iframe>

------------------------------------------------------------------------

## Codebook:

-   Metadata

-   Response Labels

***Stellt sicher dass diese Punkte auch ausgef√ºllt sind f√ºr die Schlussabgabe.***

------------------------------------------------------------------------

## Nachtrag: row.names = FALSE

`row.names = FALSE` sorgt daf√ºr, dass keine neue Spalte eingef√ºgt wird, die alle Zeilen durchnummeriert (also einen zus√§tzlichen ‚ÄûSpaltennamen‚Äú erzeugt).

Wenn ihr in eurem `dat_full` als erste Spalte eine solche Bezeichnung wie ‚Äû...1‚Äú findet, habt ihr `dat_full` wahrscheinlich ohne das Argument `row.names = FALSE` abgespeichert. Das ist nicht weiter schlimm, sollte aber bereinigt werden (z. B. mit `select()`).

```{r, eval = FALSE, echo=TRUE}

write.csv(dat_full, "data/raw/dat_full_rownames.csv")
```

```{r, echo = FALSE, message= FALSE}

dat_full_rownames <- read_csv("data/raw/dat_full_rownames.csv")
```

```{r, echo = TRUE}

dat_full_rownames[1:5, 1:3]
```

**Entfernen mit select()**

```{r, echo = TRUE, eval = FALSE, message = FALSE}

dat_full_rownames <- dat_full_rownames |> 
  select(-"...1")
```

------------------------------------------------------------------------

## Nachtrag: write.csv2()

Die beiden Funktionen unterscheiden sich nur in den **verwendeten Trennzeichen**:

-   `write.csv()` nutzt **Kommas** als **Spaltentrenner** und **Punkte** als **Dezimaltrennzeichen**.

-   `write.csv2()` nutzt **Semikolons** als **Spaltentrenner** und **Kommas** als **Dezimaltrennzeichen**.

**Bottom Line:** Nutzt `write.csv()` ‚Äì sonst kann es passieren, dass Werte mit Nachkommastellen **nicht korrekt von R interpretiert** werden.

------------------------------------------------------------------------

## Nachtrag: select()

Kann **nicht** verwendet werden, um **Rows/Zeilen** auszuw√§hlen! Auswahl von **Spalten!**

Aber: Daf√ºr gibt es Funktionen wie **`slice()`** ‚Äì allerdings wollen wir in der Regel **keine Zeilen ohne logisches Kriterium** ausw√§hlen.\
üëâ **`filter()`** ist deshalb meist die bessere Option.

```{r, echo = TRUE}

penguins |>
  select(bill_depth_mm) |>
  slice(10) 

```

------------------------------------------------------------------------

## Kombination select() und full_join() - Beispiel

```{r, echo = TRUE, message = FALSE}

penguins <- palmerpenguins::penguins
penguins <- penguins |>
  mutate(id = row_number())

penguins2 <- palmerpenguins::penguins
penguins2 <- penguins2 |>
  mutate(id = row_number())
```

```{r, echo = TRUE, eval = FALSE}

dat_final <- penguins |>
  select(id, species, year) |>
  full_join(
    penguins2 |> select(id, island, sex),
    by = "id"
  )
```

------------------------------------------------------------------------

## arrange()

**N√ºtzlich, um h√∂chste und niedrigste Werte einzusehen ‚Äì zum Beispiel, um eine Rangliste zu erstellen.**

<br><br>

```{r echo = TRUE}
penguins |> 
  arrange(bill_depth_mm)
```

------------------------------------------------------------------------

## relocate()

**Wird genutzt, um Spalten zu verschieben ‚Äì n√ºtzlich, um den Datensatz √ºbersichtlicher zu gestalten, etwa indem man wichtige Variablen (z. B. ID, Gruppe) an den Anfang stellt.**

<br><br>

```{r, echo = TRUE}

penguins |> relocate(bill_depth_mm, .before = island)
```

------------------------------------------------------------------------

## Fehlende Werte

### **Wieso m√ºssen wir √ºberhaupt fehlende Werte behandeln?**

-   Viele Funktionen in R funktionieren nur mit vollst√§ndigen Datens√§tzen.

-   Kennwerte wie Mittelwerte oder Standardabweichungen k√∂nnen nicht berechnet werden, wenn fehlende Werte enthalten sind.

-   Fehlende Werte k√∂nnen Ergebnisse verzerren, insbesondere wenn sie nicht zuf√§llig fehlen.

### **Umgang mit fehlenden Werten:**

-   Finden / Identifizieren!

-   Nachvollziehen

-   Handling - abh√§ngig von eurem Studiendesign und Fragestellungen

------------------------------------------------------------------------

## Diverse Formen von Fehlenden Werten

-   `NA` (R-typische Kennzeichnung f√ºr *Not Available*)

-   `999` oder `-999` (h√§ufig manuell gesetzte Platzhalter)

-   leere Zellen (`""`)

-   `NULL` (in manchen Programmiersprachen, aber in R selten in Datens√§tzen verwendet)

------------------------------------------------------------------------

## Finden und identifizieren von fehlenden Werten

Diverse Ans√§tze - Konkrete √úbungen in den Hands On √úbungen.

```{r, echo = TRUE}

table(is.na(penguins))
```

<br><br>

```{r, echo = TRUE}

colSums(is.na(penguins))
```

------------------------------------------------------------------------

## Fortgeschritten: Nachvollziehen!

<br><br>

-   **Missing Completely at Random (MCAR):** Fehlende Werte entstehen rein zuf√§llig und stehen in keinem Zusammenhang mit anderen Daten.\
    <br>
-   **Missing at Random (MAR):** Fehlende Werte h√§ngen mit beobachteten, aber nicht mit den fehlenden Variablen selbst zusammen.\
    <br>
-   **Missing Not at Random (MNAR):** Fehlende Werte stehen in direktem Zusammenhang mit den nicht beobachteten (fehlenden) Werten selbst.

::: notes
MCAR: W√§hrend einer Online-Studie bricht bei einigen Teilnehmenden zuf√§llig die Internetverbindung ab, sodass ihre Antworten fehlen. ‚Üí Das Fehlen ist rein zuf√§llig und unabh√§ngig von ihren Eigenschaften oder Antworten.

MAR: In einer Befragung zu Stress und Schlafqualit√§t √ºberspringen j√ºngere Teilnehmende h√§ufiger Fragen zur Schlafdauer. ‚Üí Das Fehlen h√§ngt mit dem beobachteten Merkmal *Alter* zusammen, aber nicht mit der tats√§chlichen Schlafdauer.

MNAR: Bei einer Angststudie brechen Teilnehmende mit besonders hoher Angst die Untersuchung ab, bevor sie den Angstfragebogen ausf√ºllen. ‚Üí Das Fehlen h√§ngt direkt mit dem nicht beobachteten Wert der Angstvariable zusammen.
:::

------------------------------------------------------------------------

## **M√∂gliche Ans√§tze um mit Missings umzugehen:**

**Fehlende Werte entfernen**\
Achtung: Je nach Analysemethode kann bereits **ein einziger fehlender Wert** dazu f√ºhren, dass eine ganze Versuchsperson aus der Analyse ausgeschlossen wird!

<br><br>

**Fehlende Werte imputieren**\
Das bedeutet, fehlende Werte **durch gesch√§tzte Werte zu ersetzen** (z. B. Mittelwert, Regression, Multiple Imputation).

\
‚Üí Das √ºben wir **nicht in diesem Seminar**.

------------------------------------------------------------------------

## Fehlende Werte bei Berechnungen beachten

-   Viele R-Funktionen k√∂nnen fehlende Werte automatisch ausschliessen, z. B. mit `na.rm = TRUE`

<br><br>

```{r, eval = TRUE, echo = TRUE }

x <- c(1, NA)

mean(x, na.rm = FALSE)   # fehlende Werte werden in Berechnung 	miteinbezogen, ergibt NA als Mittelwert; default Einstellung

mean(x, na.rm = TRUE)    #fehlende Werte werden ausgeschlossen, ergibt 1 als Mittelwert

```

------------------------------------------------------------------------

## Skalenberechnung

Damit wir unsere Analysen sinnvoll durchf√ºhren k√∂nnen, m√ºssen wir oft **Skalen berechnen**, also mehrere Items zu einem Gesamtwert zusammenfassen.

<br><br>

**Schritte:**

1.  **Transformation der Antwortformate** (z. B. von ‚ÄûTrifft h√§ufig zu‚Äú zu numerischen Werten).

    <br>

2.  **Beachtung von Reverse-Codierungen** (z. B. beim Konstrukt *Gewissenhaftigkeit*: Item ‚ÄûIch bin bequem, neige zur Faulheit‚Äú muss umgepolt werden).

    <br>

3.  **Berechnung der Skalenwerte** (z. B. durch Mittelwertbildung der entsprechenden Items).

------------------------------------------------------------------------

## Beispiele Berechnung von Skalenwerten

-   Einfache Variante

    <br>

```{r, eval = FALSE, echo=TRUE}

dat_full <- dat_full |> 
  mutate(mmq_mean = (question1 + question2 + question3 + question4 + question5 + question6 + question7 + question8 + question9 + question10 + question11 + question12 + question13 + question14 + question15 + question16 + question17 + question18)/18)
```

-   Sparsamerer Varianten: Dplyr Funktion verwenden um z.B. nicht alle Variablen auszuschreiben

```{r, eval = FALSE, echo=TRUE}
#Sparsamere Alternative:

dat_full <- dat_full |> 
  mutate(mmq_mean = rowMeans(select(dat_full, starts_with("question")),
                             na.rm = TRUE))

#Sparsamere Alternative:

dat_full <- dat_full |>
  mutate(mmq_mean = rowMeans(across(question1:question18), na.rm = TRUE))

#Sparsamere Alternative:

dat_full <- dat_full %>%
  rowwise() %>%
  mutate(mmq_mean3 = mean(c_across(starts_with("question")), na.rm = TRUE))

```

::: notes
na.rm = TRUE bedeutet, dass f√ºr eine Person ein Skalenwert berechnet wird wenn es mind. 1 vorhandenen Wert gibt

Wenn na.rm = FALSE, dann wird kein Skalenwert f√ºr eine Person berechnet wenn es mind 1 fehlenden Wert gibt

c_across(), sodass die Spalten (columns) ausgew√§hlt werden.
:::

------------------------------------------------------------------------

## Heute haben wir:

...Fehlende Werte und m√∂gliche Umgangsformen angeschaut

... Skalenberechnung angeschaut

------------------------------------------------------------------------

## Congrats you mastered dplyr!!

<br>

![](../../images/EH_8/logo.png){fig-align="center" width="300"}

------------------------------------------------------------------------

## Bis n√§chstes Mal

-   Haus√ºbung 1 - Abgabe bis Freitag **07.11.2025** via Ilias (Ordner: Abgaben)

-   Peer-Feedback bis n√§chsten Mittwoch **12.11.2025**

    -   Direkte Kommentierung des Quartoskripts

    -   Kurze Zusammenfassung im Forum (Ordner: EH8)!

-   Hands On Block 4 fertigstellen
